---
import Card from '../ui/Card.astro';
import Button from '../ui/Button.astro';

export interface ContactInfo {
  type: 'email' | 'phone' | 'location' | 'availability';
  label: string;
  value: string;
  href?: string;
  icon: string;
}

export interface SocialLink {
  name: string;
  href: string;
  icon: string;
  color?: string;
  username?: string;
}

export interface Props {
  title?: string;
  subtitle?: string;
  description?: string;
  contactInfo?: ContactInfo[];
  socialLinks?: SocialLink[];
  formAction?: string;
  successMessage?: string;
  enableForm?: boolean;
  class?: string;
}

const {
  title = "í”„ë¡œì íŠ¸ ìƒë‹´ ë° í˜‘ì—… ë¬¸ì˜",
  subtitle = "Contact & Collaboration",
  description = "ì›¹ ê°œë°œ í”„ë¡œì íŠ¸, React/Node.js ê¸°ìˆ  ìƒë‹´, í˜‘ì—… ê¸°íšŒì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë³´ì„¸ìš”. í’€ìŠ¤íƒ ê°œë°œ ê´€ë ¨ ë¬¸ì˜ëŠ” ì–¸ì œë“ ì§€ ì—°ë½ ì£¼ì‹œë©´ ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
  contactInfo = [],
  socialLinks = [],
  formAction = "/api/contact",
  enableForm = true,
  class: className = "",
} = Astro.props;

// Default contact info
const defaultContactInfo: ContactInfo[] = [
  {
    type: 'email',
    label: 'ì´ë©”ì¼',
    value: 'contact@example.com',
    href: 'mailto:contact@example.com',
    icon: 'ğŸ“§'
  },
  {
    type: 'phone',
    label: 'ì „í™”ë²ˆí˜¸',
    value: '+82 10-1234-5678',
    href: 'tel:+821012345678',
    icon: 'ğŸ“'
  },
  {
    type: 'location',
    label: 'ìœ„ì¹˜',
    value: 'ì„œìš¸, ëŒ€í•œë¯¼êµ­',
    icon: 'ğŸ“'
  },
  {
    type: 'availability',
    label: 'ê°€ìš©ì„±',
    value: 'í”„ë¦¬ëœìŠ¤/ì •ê·œì§ ê°€ëŠ¥',
    icon: 'ğŸ’¼'
  }
];

// Default social links
const defaultSocialLinks: SocialLink[] = [
  {
    name: 'GitHub',
    href: 'https://github.com',
    icon: 'ğŸ™',
    color: 'hover:text-gray-700 dark:hover:text-gray-300',
    username: '@username'
  },
  {
    name: 'LinkedIn',
    href: 'https://linkedin.com',
    icon: 'ğŸ’¼',
    color: 'hover:text-blue-600 dark:hover:text-blue-400',
    username: 'in/username'
  },
  {
    name: 'Twitter',
    href: 'https://twitter.com',
    icon: 'ğŸ¦',
    color: 'hover:text-sky-500 dark:hover:text-sky-400',
    username: '@username'
  },
  {
    name: 'Instagram',
    href: 'https://instagram.com',
    icon: 'ğŸ“·',
    color: 'hover:text-pink-500 dark:hover:text-pink-400',
    username: '@username'
  },
  {
    name: 'Discord',
    href: 'https://discord.com',
    icon: 'ğŸ®',
    color: 'hover:text-indigo-500 dark:hover:text-indigo-400',
    username: 'username#1234'
  },
  {
    name: 'YouTube',
    href: 'https://youtube.com',
    icon: 'ğŸ“º',
    color: 'hover:text-red-500 dark:hover:text-red-400',
    username: '@channel'
  }
];

const displayContactInfo = contactInfo.length > 0 ? contactInfo : defaultContactInfo;
const displaySocialLinks = socialLinks.length > 0 ? socialLinks : defaultSocialLinks;
---

<section 
  class={`py-20 bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800 ${className}`}
  aria-label="ì—°ë½ì²˜ ë° ë¬¸ì˜ ì„¹ì…˜"
  role="region"
  tabindex="-1"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-16">
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white mb-4">
        {title}
        <span class="block text-lg sm:text-xl font-normal text-blue-600 dark:text-blue-400 mt-2">
          {subtitle}
        </span>
      </h2>
      {description && (
        <p class="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
          {description}
        </p>
      )}
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
      <!-- Contact Information -->
      <div class="space-y-8">
        <!-- Contact Info Cards -->
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">
            ì—°ë½ì²˜ ì •ë³´
          </h3>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" role="list" aria-label="ì—°ë½ì²˜ ì •ë³´ ëª©ë¡">
            {displayContactInfo.map((info) => (
              <Card variant="bordered" class="p-4 transition-all duration-300 hover:shadow-lg" role="listitem">
                <div class="flex items-center space-x-3">
                  <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white text-lg" aria-hidden="true">
                    {info.icon}
                  </div>
                  <div class="flex-1">
                    <div class="text-sm font-medium text-gray-500 dark:text-gray-400">
                      {info.label}
                    </div>
                    {info.href ? (
                      <a 
                        href={info.href}
                        class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200"
                        aria-label={`${info.label}: ${info.value}`}
                      >
                        {info.value}
                      </a>
                    ) : (
                      <div class="text-gray-900 dark:text-white">
                        {info.value}
                      </div>
                    )}
                  </div>
                </div>
              </Card>
            ))}
          </div>
        </div>

        <!-- Social Links -->
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white">
            ì†Œì…œ ë¯¸ë””ì–´
          </h3>
          
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-4" role="list" aria-label="ì†Œì…œ ë¯¸ë””ì–´ ë§í¬ ëª©ë¡">
            {displaySocialLinks.map((social) => (
              <a 
                href={social.href}
                target="_blank"
                rel="noopener noreferrer"
                class={`group p-4 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 transition-all duration-300 hover:shadow-lg hover:scale-105 ${social.color || 'hover:text-blue-600 dark:hover:text-blue-400'}`}
                role="listitem"
                aria-label={`${social.name}ì—ì„œ ì—°ê²°í•˜ê¸°${social.username ? ` (${social.username})` : ''}`}
              >
                <div class="text-center">
                  <div class="text-2xl mb-2" aria-hidden="true">{social.icon}</div>
                  <div class="font-medium text-gray-900 dark:text-white group-hover:text-inherit">
                    {social.name}
                  </div>
                  {social.username && (
                    <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                      {social.username}
                    </div>
                  )}
                </div>
              </a>
            ))}
          </div>
        </div>

        <!-- Quick Actions -->
        <Card variant="elevated" class="p-6 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20">
          <div class="text-center">
            <div class="text-2xl mb-3">âš¡</div>
            <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
              ë¹ ë¥¸ ì—°ë½
            </h4>
            <p class="text-gray-600 dark:text-gray-400 mb-4 text-sm">
              ê¸‰í•œ ë¬¸ì˜ë‚˜ í”„ë¡œì íŠ¸ ìƒë‹´ì´ í•„ìš”í•˜ì‹ ê°€ìš”?
            </p>
            <div class="flex flex-col sm:flex-row gap-3">
              <Button 
                href="mailto:contact@example.com"
                variant="primary"
                size="sm"
                class="flex-1"
              >
                ì´ë©”ì¼ ë³´ë‚´ê¸°
              </Button>
              <Button 
                href="https://calendly.com/username"
                variant="outline"
                size="sm"
                class="flex-1"
                target="_blank"
              >
                ë¯¸íŒ… ì˜ˆì•½
              </Button>
            </div>
          </div>
        </Card>
      </div>

      <!-- Contact Form -->
      {enableForm && (
        <div class="space-y-8">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white">
            ë©”ì‹œì§€ ë³´ë‚´ê¸°
          </h3>
          
          <Card variant="elevated" class="p-6">
            <form action={formAction} method="POST" class="space-y-6">
              <!-- Name and Email Row -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    ì´ë¦„ *
                  </label>
                  <input
                    type="text"
                    id="name"
                    name="name"
                    required
                    class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                    placeholder="í™ê¸¸ë™"
                  />
                </div>
                
                <div>
                  <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    ì´ë©”ì¼ *
                  </label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                    placeholder="your@email.com"
                  />
                </div>
              </div>

              <!-- Subject -->
              <div>
                <label for="subject" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  ì œëª© *
                </label>
                <input
                  type="text"
                  id="subject"
                  name="subject"
                  required
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                  placeholder="í”„ë¡œì íŠ¸ ë¬¸ì˜"
                />
              </div>

              <!-- Project Type -->
              <div>
                <label for="project-type" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  í”„ë¡œì íŠ¸ ìœ í˜•
                </label>
                <select
                  id="project-type"
                  name="project-type"
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                >
                  <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                  <option value="web-development">ì›¹ ê°œë°œ</option>
                  <option value="mobile-app">ëª¨ë°”ì¼ ì•±</option>
                  <option value="consulting">ì»¨ì„¤íŒ…</option>
                  <option value="maintenance">ìœ ì§€ë³´ìˆ˜</option>
                  <option value="other">ê¸°íƒ€</option>
                </select>
              </div>

              <!-- Budget Range -->
              <div>
                <label for="budget" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  ì˜ˆì‚° ë²”ìœ„
                </label>
                <select
                  id="budget"
                  name="budget"
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                >
                  <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                  <option value="under-500">50ë§Œì› ë¯¸ë§Œ</option>
                  <option value="500-1000">50-100ë§Œì›</option>
                  <option value="1000-3000">100-300ë§Œì›</option>
                  <option value="3000-5000">300-500ë§Œì›</option>
                  <option value="over-5000">500ë§Œì› ì´ìƒ</option>
                  <option value="discuss">í˜‘ì˜ ê°€ëŠ¥</option>
                </select>
              </div>

              <!-- Message -->
              <div>
                <label for="message" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  ë©”ì‹œì§€ *
                </label>
                <textarea
                  id="message"
                  name="message"
                  rows="6"
                  required
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 resize-vertical"
                  placeholder="í”„ë¡œì íŠ¸ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ ì•Œë ¤ì£¼ì„¸ìš”..."
                ></textarea>
              </div>

              <!-- Privacy Notice -->
              <div class="text-xs text-gray-500 dark:text-gray-400">
                * ê°œì¸ì •ë³´ëŠ” ë¬¸ì˜ ì‘ë‹µ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ë©°, ì œ3ìì—ê²Œ ì œê³µë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
              </div>

              <!-- Submit Button -->
              <Button 
                type="submit"
                variant="primary"
                size="lg"
                class="w-full"
              >
                ë©”ì‹œì§€ ë³´ë‚´ê¸°
                <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg>
              </Button>
            </form>
          </Card>
        </div>
      )}
    </div>

    <!-- Bottom CTA -->
    <div class="mt-16 text-center">
      <Card variant="bordered" class="p-8 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20">
        <div class="max-w-2xl mx-auto">
          <div class="text-3xl mb-4">ğŸš€</div>
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
            í•¨ê»˜ ë©‹ì§„ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”!
          </h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">
            ì•„ì´ë””ì–´ê°€ ìˆìœ¼ì‹œë‹¤ë©´ ì£¼ì €í•˜ì§€ ë§ˆì„¸ìš”. ì‘ì€ í”„ë¡œì íŠ¸ë¶€í„° ëŒ€ê·œëª¨ ì‹œìŠ¤í…œê¹Œì§€, 
            ì–´ë–¤ ë„ì „ì´ë“  í•¨ê»˜ í•´ê²°í•´ë‚˜ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <Button 
              href="#contact-form"
              variant="primary"
              size="lg"
            >
              í”„ë¡œì íŠ¸ ì‹œì‘í•˜ê¸°
            </Button>
            <Button 
              href="/projects"
              variant="outline"
              size="lg"
            >
              í¬íŠ¸í´ë¦¬ì˜¤ ë³´ê¸°
            </Button>
          </div>
        </div>
      </Card>
    </div>
  </div>
</section>

<script>
  // Form submission handling
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form[action*="contact"]') as HTMLFormElement;
    
    if (form) {
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(form);
        const submitButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        const originalText = submitButton?.textContent || '';
        
        // Show loading state
        if (submitButton) {
          submitButton.disabled = true;
          submitButton.innerHTML = 'ì „ì†¡ ì¤‘... <svg class="ml-2 w-4 h-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>';
        }
        
        try {
          // For demo purposes, simulate form submission
          await new Promise(resolve => setTimeout(resolve, 2000));
          
          // Show success message
          alert('ë©”ì‹œì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤! ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
          form.reset();
          
        } catch (error) {
          console.error('Form submission error:', error);
          alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        } finally {
          // Reset button state
          if (submitButton) {
            submitButton.disabled = false;
            submitButton.innerHTML = originalText;
          }
        }
      });
    }
  });
</script> 