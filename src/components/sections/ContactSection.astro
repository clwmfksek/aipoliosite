---
import Card from '../ui/Card.astro';
import Button from '../ui/Button.astro';

export interface ContactInfo {
  type: 'email' | 'phone' | 'location' | 'availability';
  label: string;
  value: string;
  href?: string;
  icon: string;
}

export interface SocialLink {
  name: string;
  href: string;
  icon: string;
  color?: string;
  username?: string;
}

export interface Props {
  title?: string;
  subtitle?: string;
  description?: string;
  contactInfo?: ContactInfo[];
  socialLinks?: SocialLink[];
  formAction?: string;
  successMessage?: string;
  enableForm?: boolean;
  class?: string;
}

const {
  title = "ÌîÑÎ°úÏ†ùÌä∏ ÏÉÅÎã¥ Î∞è ÌòëÏóÖ Î¨∏Ïùò",
  subtitle = "Contact & Collaboration",
  description = "Ïõπ Í∞úÎ∞ú ÌîÑÎ°úÏ†ùÌä∏, React/Node.js Í∏∞Ïà† ÏÉÅÎã¥, ÌòëÏóÖ Í∏∞ÌöåÏóê ÎåÄÌï¥ Ïù¥ÏïºÍ∏∞Ìï¥Î≥¥ÏÑ∏Ïöî. ÌíÄÏä§ÌÉù Í∞úÎ∞ú Í¥ÄÎ†® Î¨∏ÏùòÎäî Ïñ∏Ï†úÎì†ÏßÄ Ïó∞ÎùΩ Ï£ºÏãúÎ©¥ Îπ†Î•∏ ÏãúÏùº ÎÇ¥Ïóê ÎãµÎ≥ÄÎìúÎ¶¨Í≤†ÏäµÎãàÎã§.",
  contactInfo = [],
  socialLinks = [],
  formAction = "/api/contact",
  enableForm = true,
  class: className = "",
} = Astro.props;

// Default contact info
const defaultContactInfo: ContactInfo[] = [
  {
    type: 'email',
    label: 'Ïù¥Î©îÏùº',
    value: 'contact@example.com',
    href: 'mailto:contact@example.com',
    icon: 'üìß'
  },
  {
    type: 'phone',
    label: 'Ï†ÑÌôîÎ≤àÌò∏',
    value: '+82 10-1234-5678',
    href: 'tel:+821012345678',
    icon: 'üìû'
  },
  {
    type: 'location',
    label: 'ÏúÑÏπò',
    value: 'ÏÑúÏö∏, ÎåÄÌïúÎØºÍµ≠',
    icon: 'üìç'
  },
  {
    type: 'availability',
    label: 'Í∞ÄÏö©ÏÑ±',
    value: 'ÌîÑÎ¶¨ÎûúÏä§/Ï†ïÍ∑úÏßÅ Í∞ÄÎä•',
    icon: 'üíº'
  }
];

// Default social links
const defaultSocialLinks: SocialLink[] = [
  {
    name: 'GitHub',
    href: 'https://github.com',
    icon: 'üêô',
    color: 'hover:text-gray-700 dark:hover:text-gray-300',
    username: '@username'
  },
  {
    name: 'LinkedIn',
    href: 'https://linkedin.com',
    icon: 'üíº',
    color: 'hover:text-blue-600 dark:hover:text-blue-400',
    username: 'in/username'
  },
  {
    name: 'Twitter',
    href: 'https://twitter.com',
    icon: 'üê¶',
    color: 'hover:text-sky-500 dark:hover:text-sky-400',
    username: '@username'
  },
  {
    name: 'Instagram',
    href: 'https://instagram.com',
    icon: 'üì∑',
    color: 'hover:text-pink-500 dark:hover:text-pink-400',
    username: '@username'
  },
  {
    name: 'Discord',
    href: 'https://discord.com',
    icon: 'üéÆ',
    color: 'hover:text-indigo-500 dark:hover:text-indigo-400',
    username: 'username#1234'
  },
  {
    name: 'YouTube',
    href: 'https://youtube.com',
    icon: 'üì∫',
    color: 'hover:text-red-500 dark:hover:text-red-400',
    username: '@channel'
  }
];

const displayContactInfo = contactInfo.length > 0 ? contactInfo : defaultContactInfo;
const displaySocialLinks = socialLinks.length > 0 ? socialLinks : defaultSocialLinks;
---

<section 
  class={`py-20 bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800 ${className}`}
  aria-label="Ïó∞ÎùΩÏ≤ò Î∞è Î¨∏Ïùò ÏÑπÏÖò"
  role="region"
  tabindex="-1"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-16">
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white mb-4">
        {title}
        <span class="block text-lg sm:text-xl font-normal text-blue-600 dark:text-blue-400 mt-2">
          {subtitle}
        </span>
      </h2>
      {description && (
        <p class="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
          {description}
        </p>
      )}
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
      <!-- Contact Information -->
      <div class="space-y-8">
        <!-- Contact Info Cards -->
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">
            Ïó∞ÎùΩÏ≤ò Ï†ïÎ≥¥
          </h3>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" role="list" aria-label="Ïó∞ÎùΩÏ≤ò Ï†ïÎ≥¥ Î™©Î°ù">
            {displayContactInfo.map((info) => (
              <Card variant="bordered" class="p-4 transition-all duration-300 hover:shadow-lg" role="listitem">
                <div class="flex items-center space-x-3">
                  <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white text-lg" aria-hidden="true">
                    {info.icon}
                  </div>
                  <div class="flex-1">
                    <div class="text-sm font-medium text-gray-500 dark:text-gray-400">
                      {info.label}
                    </div>
                    {info.href ? (
                      <a 
                        href={info.href}
                        class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200"
                        aria-label={`${info.label}: ${info.value}`}
                      >
                        {info.value}
                      </a>
                    ) : (
                      <div class="text-gray-900 dark:text-white">
                        {info.value}
                      </div>
                    )}
                  </div>
                </div>
              </Card>
            ))}
          </div>
        </div>

        <!-- Social Links -->
        <div class="space-y-6">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white">
            ÏÜåÏÖú ÎØ∏ÎîîÏñ¥
          </h3>
          
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-4" role="list" aria-label="ÏÜåÏÖú ÎØ∏ÎîîÏñ¥ ÎßÅÌÅ¨ Î™©Î°ù">
            {displaySocialLinks.map((social) => (
              <a 
                href={social.href}
                target="_blank"
                rel="noopener noreferrer"
                class={`group p-4 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 transition-all duration-300 hover:shadow-lg hover:scale-105 ${social.color || 'hover:text-blue-600 dark:hover:text-blue-400'}`}
                role="listitem"
                aria-label={`${social.name}ÏóêÏÑú Ïó∞Í≤∞ÌïòÍ∏∞${social.username ? ` (${social.username})` : ''}`}
              >
                <div class="text-center">
                  <div class="text-2xl mb-2" aria-hidden="true">{social.icon}</div>
                  <div class="font-medium text-gray-900 dark:text-white group-hover:text-inherit">
                    {social.name}
                  </div>
                  {social.username && (
                    <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                      {social.username}
                    </div>
                  )}
                </div>
              </a>
            ))}
          </div>
        </div>

        <!-- Quick Actions -->
        <Card variant="elevated" class="p-6 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20">
          <div class="text-center">
            <div class="text-2xl mb-3">‚ö°</div>
            <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
              Îπ†Î•∏ Ïó∞ÎùΩ
            </h4>
            <p class="text-gray-600 dark:text-gray-400 mb-4 text-sm">
              Í∏âÌïú Î¨∏ÏùòÎÇò ÌîÑÎ°úÏ†ùÌä∏ ÏÉÅÎã¥Ïù¥ ÌïÑÏöîÌïòÏã†Í∞ÄÏöî?
            </p>
            <div class="flex flex-col sm:flex-row gap-3">
              <Button 
                href="mailto:contact@example.com"
                variant="primary"
                size="sm"
                class="flex-1"
              >
                Ïù¥Î©îÏùº Î≥¥ÎÇ¥Í∏∞
              </Button>
              <Button 
                href="https://calendly.com/username"
                variant="outline"
                size="sm"
                class="flex-1"
                target="_blank"
              >
                ÎØ∏ÌåÖ ÏòàÏïΩ
              </Button>
            </div>
          </div>
        </Card>
      </div>

      <!-- Contact Form -->
      {enableForm && (
        <div class="space-y-8">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white">
            Î©îÏãúÏßÄ Î≥¥ÎÇ¥Í∏∞
          </h3>
          
          <Card variant="elevated" class="p-6">
            <form action={formAction} method="POST" class="space-y-6">
              <!-- Name and Email Row -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Ïù¥Î¶Ñ *
                  </label>
                  <input
                    type="text"
                    id="name"
                    name="name"
                    required
                    class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                    placeholder="ÌôçÍ∏∏Îèô"
                  />
                </div>
                
                <div>
                  <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Ïù¥Î©îÏùº *
                  </label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                    placeholder="your@email.com"
                  />
                </div>
              </div>

              <!-- Subject -->
              <div>
                <label for="subject" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  Ï†úÎ™© *
                </label>
                <input
                  type="text"
                  id="subject"
                  name="subject"
                  required
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                  placeholder="ÌîÑÎ°úÏ†ùÌä∏ Î¨∏Ïùò"
                />
              </div>

              <!-- Project Type -->
              <div>
                <label for="project-type" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  ÌîÑÎ°úÏ†ùÌä∏ Ïú†Ìòï
                </label>
                <select
                  id="project-type"
                  name="project-type"
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                >
                  <option value="">ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</option>
                  <option value="web-development">Ïõπ Í∞úÎ∞ú</option>
                  <option value="mobile-app">Î™®Î∞îÏùº Ïï±</option>
                  <option value="consulting">Ïª®ÏÑ§ÌåÖ</option>
                  <option value="maintenance">Ïú†ÏßÄÎ≥¥Ïàò</option>
                  <option value="other">Í∏∞ÌÉÄ</option>
                </select>
              </div>

              <!-- Budget Range -->
              <div>
                <label for="budget" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  ÏòàÏÇ∞ Î≤îÏúÑ
                </label>
                <select
                  id="budget"
                  name="budget"
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200"
                >
                  <option value="">ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</option>
                  <option value="under-500">50ÎßåÏõê ÎØ∏Îßå</option>
                  <option value="500-1000">50-100ÎßåÏõê</option>
                  <option value="1000-3000">100-300ÎßåÏõê</option>
                  <option value="3000-5000">300-500ÎßåÏõê</option>
                  <option value="over-5000">500ÎßåÏõê Ïù¥ÏÉÅ</option>
                  <option value="discuss">ÌòëÏùò Í∞ÄÎä•</option>
                </select>
              </div>

              <!-- Message -->
              <div>
                <label for="message" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                  Î©îÏãúÏßÄ *
                </label>
                <textarea
                  id="message"
                  name="message"
                  rows="6"
                  required
                  class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 resize-vertical"
                  placeholder="ÌîÑÎ°úÏ†ùÌä∏Ïóê ÎåÄÌïú ÏûêÏÑ∏Ìïú ÎÇ¥Ïö©ÏùÑ ÏïåÎ†§Ï£ºÏÑ∏Ïöî..."
                ></textarea>
              </div>

              <!-- Privacy Notice -->
              <div class="text-xs text-gray-500 dark:text-gray-400">
                * Í∞úÏù∏Ï†ïÎ≥¥Îäî Î¨∏Ïùò ÏùëÎãµ Î™©Ï†ÅÏúºÎ°úÎßå ÏÇ¨Ïö©ÎêòÎ©∞, Ï†ú3ÏûêÏóêÍ≤å Ï†úÍ≥µÎêòÏßÄ ÏïäÏäµÎãàÎã§.
              </div>

              <!-- Submit Button -->
              <Button 
                type="submit"
                variant="primary"
                size="lg"
                class="w-full"
              >
                Î©îÏãúÏßÄ Î≥¥ÎÇ¥Í∏∞
                <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg>
              </Button>
            </form>
          </Card>
        </div>
      )}
    </div>

    <!-- Bottom CTA -->
    <div class="mt-16 text-center">
      <Card variant="bordered" class="p-8 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20">
        <div class="max-w-2xl mx-auto">
          <div class="text-3xl mb-4">üöÄ</div>
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
            Ìï®Íªò Î©ãÏßÑ ÌîÑÎ°úÏ†ùÌä∏Î•º ÎßåÎì§Ïñ¥Î≥¥ÏÑ∏Ïöî!
          </h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">
            ÏïÑÏù¥ÎîîÏñ¥Í∞Ä ÏûàÏúºÏãúÎã§Î©¥ Ï£ºÏ†ÄÌïòÏßÄ ÎßàÏÑ∏Ïöî. ÏûëÏùÄ ÌîÑÎ°úÏ†ùÌä∏Î∂ÄÌÑ∞ ÎåÄÍ∑úÎ™® ÏãúÏä§ÌÖúÍπåÏßÄ, 
            Ïñ¥Îñ§ ÎèÑÏ†ÑÏù¥Îì† Ìï®Íªò Ìï¥Í≤∞Ìï¥ÎÇòÍ∞à Ïàò ÏûàÏäµÎãàÎã§.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <Button 
              href="#contact-form"
              variant="primary"
              size="lg"
            >
              ÌîÑÎ°úÏ†ùÌä∏ ÏãúÏûëÌïòÍ∏∞
            </Button>
            <Button 
              href="/projects"
              variant="outline"
              size="lg"
            >
              Ìè¨Ìä∏Ìè¥Î¶¨Ïò§ Î≥¥Í∏∞
            </Button>
          </div>
        </div>
      </Card>
    </div>
  </div>
</section>

<script>
  // Form submission handling
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form[action*="contact"]') as HTMLFormElement;
    
    if (form) {
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(form);
        const submitButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        const originalText = submitButton?.textContent || '';
        
        // Show loading state
        if (submitButton) {
          submitButton.disabled = true;
          submitButton.innerHTML = 'Ï†ÑÏÜ° Ï§ë... <svg class="ml-2 w-4 h-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>';
        }
        
        try {
          // For demo purposes, simulate form submission
          await new Promise(resolve => setTimeout(resolve, 2000));
          
          // Show success message
          alert('Î©îÏãúÏßÄÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÑÏÜ°ÎêòÏóàÏäµÎãàÎã§! Îπ†Î•∏ ÏãúÏùº ÎÇ¥Ïóê ÎãµÎ≥ÄÎìúÎ¶¨Í≤†ÏäµÎãàÎã§.');
          form.reset();
          
        } catch (error) {
          console.error('Form submission error:', error);
          alert('Ï†ÑÏÜ° Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
        } finally {
          // Reset button state
          if (submitButton) {
            submitButton.disabled = false;
            submitButton.innerHTML = originalText;
          }
        }
      });
    }
  });
</script> 